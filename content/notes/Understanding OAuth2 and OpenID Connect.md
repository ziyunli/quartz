---
title: "Understanding OAuth2 and OpenID Connect"
date: 2023-07-05
---

# OAuth2

OAuth2[^1] is an open standard for users to give one application permission to access their information in another application. The steps to grant permission, or _consent_, are often referred to as _authorization_ or _delegated authorization_. 

The below diagram [^2] describes the user flow of OAuth2 Authorization Code Grant[^3]. It's important to note that the **Client** and the **Authorization Server** have already established a working relationship by sharing the **Client ID** and **Client Secret** (generated by the **Authorization Server**). The handshakes to exchange **authorization code** and **access token** happens between the **Client** and **Authorization Server**. The **Resource Owner** participates the first half of the flow with the **Authorization Server** to perform the authentication and consent.

![OAuth Flow](assets/oauth2-flow.png) 
# OpenID Connect

OAuth2 is designed only for _authorization_, OpenID Connect (OIDC)[^4] builds on top of OAuth2 for _authentication_, i.e. establishing a login session. OIDC enables scenarios where one login can be used across multiple applications, known as *single sign-on (SSO)*.

The OpenID Connect flow looks the same as OAuth. The only differences are, in the initial request, a specific scope of `openid` is used, and in the final exchange the **Client** receives both an **Access Token** and an **ID Token**.

An **ID Token** is a specifically formatted string of characters known as a JSON Web Token, or JWT. JWTs are sometimes pronounced “jots.” The **Client** can extract information embedded in the JWT such as your ID, name, when you logged in, the **ID Token** expiration, and if anything has tried to tamper with the JWT. The data inside the **ID Token** are called _claims_.

How SSO works with OIDC is implementation specific, but typically when you login at the authorization server, you receive a login session cookie with the server that is used to give you the SSO experience[^5].

![OIDC Flow](assets/oidc-flow.png)

# Terminology

| Name                 | Description                                                                                                                                                                                                                   |
| -------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Authentication       | Establishing a login session                                                                                                                                                                                                  |
| Authorization        | Grant permission, or consent                                                                                                                                                                                                  |
| Identity             | The information about the person logged in, i.e. the **Resource Owner**.                                                                                                                                                      |
| Identity Provider    | An **Authorization Server** that supports OIDC.                                                                                                                                                                                                                              |
| Resource Owner       | You! Or the user that owns identity, data, etc.                                                                                                                                                                               |
| Client               | The application that wants to access data or perform actions on behalf of the **Resource Owner**.                                                                                                                             |
| Authorization Server | The application that knows the **Resource Owner**, where the **Resource Owner** already has an account.                                                                                                                       |
| Resource Server      | The API or service the *Client* wants to use on behalf of the *Resource Owner*. It may or may not be the same as the *Authorization Server*                                                                                   |
| Redirect URI         | The URL the *Authorization Server* will redirect the *Resource Owner* back to after granting permission to the *Client*. The "Callback URL"                                                                                   |
| Response Type        | The type of information the *Client* expect to receive, e.g. `code` means an *Authorization Code*                                                                                                                             |
| Scope                | The granular permissions the *Client* wants.                                                                                                                                                                                  |
| Consent              | The *Authorization Server* takes the *scope* the *Client* is requesting, and verifies with the *Resource Owner* whether or not they want to give the *Client* permission. Usually this is a confirmation window in a browser. |
| Client ID            | This ID is used to identify the **Client** with the **Authorization Server**                                                                                                                                                  |
| Client Secret        | This is a secret password that only the **Client** and **Authorization Server** know.                                                                                                                                         |
| Authorization Code   | A short-lived temporary code the **Client** gives the **Authorization Server** in exchange for an **Access Token**.                                                                                                           |
| Access Token         | The key the client will use to communicate with the **Resource Server**.                                                                                                                                                      |
| ID Token             | A JWT that include the **claims** data, such as your ID, name, when you logged in, the **ID Token** expiration, and if anything has tried to tamper with the JWT.                                                             |


[^1]: https://oauth.net/2/
[^2]: https://developer.okta.com/blog/2019/10/21/illustrated-guide-to-oauth-and-oidc "An Illustrated Guide to OAuth and OpenID Connect"
[^3]: https://oauth.net/2/grant-types/authorization-code/ "OAuth 2.0 Authorization Code Grant"
[^4]: https://openid.net/connect/
[^5]: https://stackoverflow.com/questions/68890677/sso-with-openid-connect "SSO with OpenID connect?"